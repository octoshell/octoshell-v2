- @finish_states={'COMPLETED'=>'far fa-grin-beam','NODE_FAIL'=>'far fa-grimace','FAILED'=>'far fa-frown','CANCELLED'=>'far fa-meh-rolling-eyes','TIMEOUT'=>'far fa-flushed'}

// pass ruby variables to js
- group_plus = @rules_plus['groups']
- def_icon = {'icon'=>'far fa-exclamation-triangle'}

javascript:
  var jobs=#{{@jobs_plus.to_json}}
  var jobs_feedback=#{{@jobs_feedback.to_json}}
  var current_user=#{@current_user.id}
  var agree_flags=#{{@agree_flags.to_json}}
  var rules_plus=#{{@rules_plus.to_json}}
  var filters=#{{@filters.to_json}}
  var emails=#{{@emails.to_json}}

  var rule_pic_other = '<i class="fas fa-fw fa-exclamation-triangle" title="......"></i>'
  // {user:int, cluster: string, job_id: int, task_id: int, class=int, feedback=string},{...}
  $(function(){
    var len=filters.length;
    if (len>0) {
      $('#hidden_count').text('Ð¡ÐºÑ€Ñ‹Ñ‚Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»: '+len)
    }
    else {
      $('#hidden_count').text('ÐÐµÑ‚ ÑÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð».')
    }
    // mark hidden rules
    filters.forEach(function(rule){
      $("#btn-hide-"+rule).addClass("tinted")
    })
    // mark disabled email notifications
    emails.forEach(function(rule){
      $("#btn-email-"+rule).addClass("tinted")
    })
  });

h3 Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡Ð°Ñ…

p ÐÐ° Ð´Ð°Ð½Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ð²Ð°ÑˆÐ¸Ñ… Ð·Ð°Ð´Ð°Ñ‡Ð°Ñ…, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¾Ñ†ÐµÐ½Ð¸Ñ‚ÑŒ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ñ… Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ. Ð”Ð»Ñ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑƒÑŽÑ‰Ð¸Ñ… Ð·Ð°Ð´Ð°Ñ‡ ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ Ð½Ð¸Ð¶Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÐ¼Ñ‹Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹.

= render "form"

div class='thanks' id='thanks_box'
  div &nbsp;
  div class="thanks-text"
    | Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾!
  div &nbsp;

- if @notice
  p style = 'color:#FF0000;' = @notice

  /button onClick="$('#agree_all_confirmation').addClass('target')" id='agree_all'
    | Ð¯ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ Ñ Ð¾Ñ†ÐµÐ½ÐºÐ°Ð¼Ð¸ Ð¼Ð¾Ð¸Ñ… Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð²
  /div class="octo-popup" id="agree_all_confirmation"
    /div class="content"
    form onSubmit="$('#agree_all_confirmation').removeClass('target');agree_all(); return false"
      div class="centered"
        | Ð’ÑÐµ Ð·Ð°Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ Ð±ÐµÐ· Ð¾Ñ†ÐµÐ½Ð¾Ðº Ð¿Ð¾ Ð’Ð°ÑˆÐ¸Ð¼ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ð¼ Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ñ‚Ð¼ÐµÑ‡ÐµÐ½Ñ‹ ÐºÐ°Ðº 
        strong "ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¾Ð¹"
      div class="centered"
        button class="btn-info" type="submit"
          | Ð”Ð°, Ñ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ ÑÐ¾ Ð²ÑÐµÐ¼Ð¸ Ð¾Ñ†ÐµÐ½ÐºÐ°Ð¼Ð¸!
        button onClick="$('#agree_all_confirmation').removeClass('target'); return false"
          | ÐŸÐµÑ€ÐµÐ´ÑƒÐ¼Ð°Ð»
  /a class="octo-close-popup" onClick="$('#agree_all_confirmation').removeClass('target'); return false"

  /| ÐÐµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ñ‹ Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¾Ð¹ Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð²?
  /div id='disagree_reason_box' style="display: none; width: 100%" class="feedback_div"
    br
    | Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² ÑÐ¿Ð¸ÑÐºÐµ Ð½Ð¸Ð¶Ðµ (Ð»ÐµÐ²Ñ‹Ð¹ ÑÑ‚Ð¾Ð»Ð±ÐµÑ†), Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÑÑ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¸ Ð½ÐµÐ²ÐµÑ€Ð½Ð¾ (Ð² ÑÐ¿Ð¸ÑÐºÐµ Ð½Ð¸Ð¶Ðµ):
    div style="width: 100%" id="disagree_rules" class="feedback_list"
      | - ÐŸÐ¾ÐºÐ° Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹ Ð·Ð°Ð´Ð°Ñ‡Ð¸, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð² ÑÐ¿Ð¸ÑÐºÐµ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»...
    br
    | ÐŸÐ¾ÑÑÐ½Ð¸Ñ‚Ðµ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð’Ñ‹ Ð½Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ñ‹ Ñ ÑÑ‚Ð¸Ð¼Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸?
    input type='text' id='disagree_reason' style="right: 0px; width: 99%"
    br
  /button id="disagree_button" onClick="multi_job_feedback()" alt="ÐÐµ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½!"
    | Ð–Ð¼Ð¸Ñ‚Ðµ Ñ‚ÑƒÑ‚!
div
  br
  p 
    | Ð’ ÑÑ‚Ð¾Ð»Ð±Ñ†Ðµ "ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹" ÑƒÐºÐ°Ð·Ð°Ð½Ñ‹ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒÑŽ, Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð´Ð°Ð½Ð½Ð¾Ð¹ Ð·Ð°Ð´Ð°Ñ‡Ð¸. Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ð¸Ñ… ÐºÑ€Ð°Ñ‚ÐºÐ¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ, ÑÐºÑ€Ñ‹Ñ‚ÑŒ Ð¸Ñ… Ð²Ð¸Ð´Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸Ñ… Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ðº Ð·Ð°Ð´Ð°Ñ‡Ðµ, Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð½Ð°Ð¶Ð°Ñ‚ÑŒ Ð½Ð° Ð·Ð½Ð°Ñ‡Ð¾Ðº 
    i class="fas fa-bars"
    | . Ð—Ð½Ð°Ñ‡Ð¾Ðº ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ Ñ‚Ð¸Ð¿Ñƒ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ð¾Ð¹ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ (Ð½ÐµÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ MPI, Ð½Ð¸Ð·ÐºÐ°Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ð¹ Ð² Ð¿Ð°Ð¼ÑÑ‚ÑŒ Ð¸ Ñ‚.Ð´.). Ð¦Ð²ÐµÑ‚ Ð¾Ð±Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚ ÐµÐµ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ (ÐºÑ€Ð°ÑÐ½Ñ‹Ð¹ â€“ Ñ€Ð°Ð´Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ðµ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð¸Ð»Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð½ÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾, Ñ‡ÐµÑ€Ð½Ñ‹Ð¹ - Ð·Ð°Ð¼ÐµÑ‚Ð½Ð¾Ðµ ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ðµ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸, Ð·ÐµÐ»ÐµÐ½Ñ‹Ð¹ â€“ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ Ð¸Ð»Ð¸ Ð¾Ð½Ð¸ Ð½ÐµÑÑƒÑ‰ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹).
  p ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ñ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒÑŽ, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð´Ñ€ÑƒÐ³Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð½Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð·Ð°Ð´Ð°Ñ‡Ðµ, Ð¿Ñ€Ð¸Ð²ÐµÐ´ÐµÐ½Ñ‹ Ð½Ð° Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ. Ð§Ñ‚Ð¾Ð±Ñ‹ Ð¿Ð¾Ð¿Ð°ÑÑ‚ÑŒ Ð½Ð° ÑÑ‚Ñƒ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ, Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð½Ð°Ð¶Ð°Ñ‚ÑŒ Ð½Ð° ID ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ð·Ð°Ð´Ð°Ñ‡Ð¸.
  p 
    | ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ñ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒÑŽ, Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð¸Ñ… Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¸Ð»Ð¸ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ ÑÐ²Ð¾Ðµ Ð½Ð¾Ð²Ð¾Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾ Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼ Ñ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð° 
    a href='all_rules' ÑÑ‚Ð¾Ð¹ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
    |.
  p 
    | Ð•ÑÑ‚ÑŒ Ð¾Ð±Ñ‰Ð¸Ðµ Ð¿Ð¾Ð¶ÐµÐ»Ð°Ð½Ð¸Ñ Ð¸Ð»Ð¸ Ð·Ð°Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ? 
    a href='mailto://feedback-octoshell@parallel.ru' ÐÐ°Ð¿Ð¸ÑˆÐ¸Ñ‚Ðµ Ð½Ð°Ð¼
    | .
div
  button onClick="$('#mass_notok').addClass('target'); multi_job_feedback_start()"
    | Ð¯ Ð½Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ Ñ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼Ð¸ Ð¾Ñ†ÐµÐ½ÐºÐ°Ð¼Ð¸...
  div id="mass_notok" class='roll-down col-12'
    p Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð½ÑƒÐ¶Ð½Ñ‹Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ¸ Ð³Ð°Ð»Ð¾Ñ‡ÐºÐ°Ð¼Ð¸ Ð² Ð»ÐµÐ²Ð¾Ð¼ ÑÑ‚Ð¾Ð»Ð±Ñ†Ðµ.
      Ð’ Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ Ð½Ð¸Ð¶Ðµ Ð±ÑƒÐ´ÑƒÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð½Ñ‹ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°, Ð¾Ð±Ñ‰Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð°Ð¿ÑƒÑÐºÐ¾Ð².
      Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð²ÑÐµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°, Ñ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼Ð¸ Ð’Ñ‹ Ð½Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ñ‹ Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð°Ð¼ Ð¾Ñ‚Ð·Ñ‹Ð².

    div id="disagree_rules" class="feedback_list col-12"
      | - ÐŸÐ¾ÐºÐ° Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹ Ð·Ð°Ð´Ð°Ñ‡Ð¸, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð² ÑÐ¿Ð¸ÑÐºÐµ Ð½ÐµÑ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»...

    button onclick="$('#mass_notok_confirm').addClass('target')"
      | ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²
    button onclick="$('#mass_notok').removeClass('target')"
      | ÐŸÐµÑ€ÐµÐ´ÑƒÐ¼Ð°Ð» Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð²

    div id="mass_notok_confirm" class="octo-popup"
      | ÐŸÐ¾ÑÑÐ½Ð¸Ñ‚Ðµ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð’Ñ‹ Ð½Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ñ‹ Ñ ÑÑ‚Ð¸Ð¼Ð¸ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸?
      input type='text' id='disagree_reason' style="right: 0px; width: 99%"
      div class="centered"
        button class="btn-info" onClick="multi_job_feedback(); $('#mass_notok').removeClass('target'); $('#mass_agree').removeClass('target'); $('#mass_notok_confirm').removeClass('target')"
          | ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ!
        button class="btn-info" onClick="$('#mass_notok_confirm').removeClass('target');"
          | ÐŸÐµÑ€ÐµÐ´ÑƒÐ¼Ð°Ð»
    a class="octo-close-popup" onClick="$('#mass_notok_confirm').removeClass('target'); return false"


div class="perf-table"
  /p
    | Sort by &nbsp;
    a class="btn btn-info sorting" data-column="8" data-direction="0" data-item="0" num nodes
    | &nbsp;
    a class="btn btn-info sorting" data-column="8" data-direction="0" data-item="1" duration
    | &nbsp;
    a class="btn btn-info sorting" data-column="8" data-direction="0" data-item="2" core*hours
  input type="checkbox" class="hide-login-data" id="hide-login-checkbox" checked=1
  label for="hide-login-checkbox" Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸Ð½/Ñ€Ð°Ð·Ð´ÐµÐ»
  br
  input type="checkbox" class="hide-perf-data" id="hide-perf-checkbox"
  label for="hide-perf-checkbox" Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸

  h3
    - if @total_count==0
      | ÐÐµÑ‚ Ð·Ð°Ð´Ð°Ñ‡ Ñ Ñ‚Ð°ÐºÐ¸Ð¼Ð¸ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð°Ð¼Ð¸...
    - else
      | ÐŸÐ¾ÐºÐ°Ð·Ð°Ð½Ñ‹ Ð·Ð°Ð´Ð°Ñ‡Ð¸: #{@params[:offset]}..#{@params[:offset].to_i + @shown} Ð¸Ð· #{@total_count}
      p id="hidden_count"
      table
        tr
          td
            - if @params[:offset].to_i >= @PER_PAGE
              a href="#{url_for @params.except(:offset).merge(offset: @params[:offset].to_i - @PER_PAGE)}" <<<
          td width="10px"
          td
            - if @jobs.length == 100
              a href="#{url_for @params.except(:offset).merge(offset: @params[:offset].to_i + @PER_PAGE)}" >>>
      table id="jobs" class="table table-bordered tablesorter-default fixed-layout"
        thead
          tr
            th data-sorter="false"
              |
            th data-sorter="false"
              | ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹
            th
              | ID Ð·Ð°Ð´Ð°Ñ‡Ð¸
            th class="login-data"
              | Ð›Ð¾Ð³Ð¸Ð½
            th class="login-data"
              | Ð Ð°Ð·Ð´ÐµÐ»
            th
              | ÐÐ°Ñ‡Ð°Ð»Ð¾ ÑÑ‡ÐµÑ‚Ð°
            th
              | ÐšÐ¾Ð½ÐµÑ† ÑÑ‡ÐµÑ‚Ð°
            th class="icon-x2-width"
              | Ð¡Ñ‚Ð°Ñ‚ÑƒÑ
            th
              / class="triplesort"
              | Ð§Ð¸ÑÐ»Ð¾ ÑƒÐ·Ð»Ð¾Ð²
            th
              | Ð’Ñ€ÐµÐ¼Ñ ÑÑ‡ÐµÑ‚Ð°, Ð² Ñ‡Ð°ÑÐ°Ñ…
            th
              | Ð Ð°Ð·Ð¼ÐµÑ€ Ð·Ð°Ð´Ð°Ñ‡Ð¸ (Ð¦ÐŸÐ£-Ñ‡Ð°ÑÑ‹)
            /th class="perf-data"
              | job size
            th class="perf-data"
              | Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¦ÐŸÐ£
            th class="perf-data"
              | Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð“ÐŸÐ£
            th class="perf-data"
              | Load average
            th class="perf-data"
              | IPC
            th class="perf-data"
              | ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¾ Ð±Ð°Ð¹Ñ‚ Ð¿Ð¾ MPI, Ð² ÐœÐ‘
            th class="perf-data"
              | ÐŸÐµÑ€ÐµÐ´Ð°Ð½Ð¾ Ð±Ð°Ð¹Ñ‚ Ð¿Ð¾ MPI, Ð² ÐœÐ‘
        - index=1
        - @jobs.each do |job|
          - index+=1
          - job_performance = job.get_performance
          - job_ranking = job.get_ranking
          - #job_cond = job.get_rules @current_user #@jobs_plus[job.drms_job_id]['rules']
          - job_cond = @jobs_plus[job.drms_job_id]['rules'].keys
          - perf_data_present=!job_performance[:cpu_user].nil?
          tr id="job_row_#{job.drms_job_id}" data-jobid="#{job.drms_job_id}" data-info-state="#{perf_data_present ? 0 : -1}"
            td
              input type="checkbox" class="job_check" style="display: none;" data-job-id="#{job.drms_job_id}" onChange="job_check_clicked(#{job.drms_job_id})"
              a class="red-on-hover" onClick="$('#job_info_#{index}').addClass('target')"
                i class="fas fa-bars"
              // feedback dropdown window
              div id="job_info_#{index}" class="octo-popup"
                a class="octo-popup-close" onClick="$('#job_info_#{index}').removeClass('target')"&times;
                - if perf_data_present
                  - if job_cond.size > 0
                    - job_cond.each do |cond|
                      div class="cond-div #{@filters.include?(cond) ? 'hidden' : 'visible'}" data-rule-div="#{cond}"
                        // current feedback icon
                        - feedback=@jobs_plus[job.drms_job_id]['feedback']
                        i id="af-#{job.drms_job_id}-#{cond}" class="#{@agree_flags[feedback.fetch(cond,99)]}"
                        /'fa-ok agreed-flag'
                        | &nbsp;
                        
                        // "hide rule" button
                        button class="btn-danger" onClick="popup_show('hide#{job.drms_job_id}_#{cond}','question_hide#{job.drms_job_id}_#{cond}');" title="Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾"
                          i class="far fa-bell-slash"
                        | &nbsp; 

                        // "I disagree with rule" button
                        button class="btn-warning disagree-button" onClick="popup_show('disagree#{job.drms_job_id}_#{cond}','question_#{job.drms_job_id}_#{cond}');" title="ÐÐµ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½!"
                          i class="#{@agree_flags[1]}"
                          /"far fa-angry"
                        | &nbsp; 
                        
                        button class="btn-warning" onClick="popup_show('agree#{job.drms_job_id}_#{cond}','question_#{job.drms_job_id}_#{cond}');" title="Ð¡Ð¾Ð³Ð»Ð°ÑÐµÐ½ Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¾Ð¹."
                          i class="#{@agree_flags[0]}"
                        | &nbsp; 
                        
                        // rule icon
                        - rule = @rules_plus['rules'].fetch(cond, nil)
                        - icon = rule ? group_plus.fetch(rule['group'],def_icon) : def_icon
                        a href="all_rules#go-#{cond}"
                          i class="em15 fa-fw align-left inline #{icon['icon']} #{icon['color']}" title="ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ðº Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÑŽ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°"
                        | &nbsp; 

                        = @rules_plus['rules'].fetch(cond,{}).fetch('description','ÐžÐ¹, Ñƒ Ð½Ð°Ñ Ñ‚ÑƒÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ñ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸ÐµÐ¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°, ÑÐ¾Ð¾Ð±Ñ‰Ð¸Ñ‚Ðµ Ð½Ð°Ð¼ Ð¾Ð± ÑÑ‚Ð¾Ð¼, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°.')

                        // agree/disagree one rule dialog
                        /div class="octo-popup2 container" id="vote-#{job.drms_job_id}-#{cond}"
                          a class="btn" onClick="agree('#{job.drms_job_id}','#{cond}');$('#vote-#{job.drms_job_id}-#{cond}').removeClass('target')"
                            i class="far fa-thumbs-up agreed-flag"
                            | Ð¡Ð¾Ð³Ð»Ð°ÑÐµÐ½ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾Ð¼!
                          br
                          a class="btn" onClick="disagree('#{job.drms_job_id}','#{cond}');$('#vote-#{job.drms_job_id}-#{cond}').removeClass('target')"
                            i class="far fa-thumbs-down agreed-flag"
                            | ÐÐµ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾Ð¼!
                          br
                        /a class="octo-close-popup2" onClick="$('#vote-#{job.drms_job_id}-#{cond}').removeClass('target')"

                        // "why hide?" dialog
                        div class="octo-popup2 container" id="popup_hide#{job.drms_job_id}_#{cond}"
                            /div class="content container"
                            form onSubmit="popup_hide('hide#{job.drms_job_id}_#{cond}');hide_rule(#{job.drms_job_id},'#{cond}'); return false;"
                              div class="centered"
                                | Ð­Ñ‚Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾ Ð±ÑƒÐ´ÐµÑ‚ ÑÐºÑ€Ñ‹Ñ‚Ð¾ Ð²Ð¾ Ð²ÑÐµÑ… Ð·Ð°Ð´Ð°Ð½Ð¸ÑÑ…, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð±ÑƒÐ´ÑƒÑ‰Ð¸Ñ…. ÐŸÐ¾ÑÑÐ½Ð¸Ñ‚Ðµ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð’Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑÐºÑ€Ñ‹Ñ‚ÑŒ ÐµÐ³Ð¾?
                              input type="text" id="question_hide#{job.drms_job_id}_#{cond}" class="fullwidth"
                              div class="centered col-12"
                                button class="btn-info" type="submit"
                                  | ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ!
                                button class="btn-info" onClick="return popup_hide('hide#{job.drms_job_id}_#{cond}');"
                                  | ÐŸÐµÑ€ÐµÐ´ÑƒÐ¼Ð°Ð»
                        a class="octo-close-popup2" onClick="return popup_hide('hide#{job.drms_job_id}_#{cond}');"


                        // "Disagree" dialog
                        div class="octo-popup2 container" id="popup_disagree#{job.drms_job_id}_#{cond}"
                          form onSubmit="popup_hide('disagree#{job.drms_job_id}_#{cond}');disagree('#{job.drms_job_id}','#{cond}',0); return false;"
                            div class="centered"
                              | ÐŸÐ¾ÑÑÐ½Ð¸Ñ‚Ðµ, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð’Ñ‹ Ð½Ðµ ÑÐ¾Ð³Ð»Ð°ÑÐ½Ñ‹ Ñ Ð¾Ñ†ÐµÐ½ÐºÐ¾Ð¹ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°?
                            input type="text" id="question_#{job.drms_job_id}_#{cond}" class="fullwidth"
                            div class="centered"
                              button class="btn-info" type="submit"
                                | ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ!
                              button class="btn-info" onClick="return popup_hide('disagree#{job.drms_job_id}_#{cond}')"
                                | ÐŸÐµÑ€ÐµÐ´ÑƒÐ¼Ð°Ð»
                        a class="octo-close-popup2" onClick="return popup_hide('disagree#{job.drms_job_id}_#{cond}')"

                        // 'Agree' dialog
                        div class="octo-popup2 container" id="popup_agree#{job.drms_job_id}_#{cond}"
                          form onSubmit="popup_hide('agree#{job.drms_job_id}_#{cond}'); agree('#{job.drms_job_id}','#{cond}',0,''); return false;"
                            div class="centered"
                              button class="btn-info" type="submit"
                                | Ð”Ð°, Ñ ÑÐ¾Ð³Ð»Ð°ÑÐµÐ½ Ñ ÑÑ‚Ð¸Ð¼ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð¾Ð¼ Ð´Ð»Ñ ÑÑ‚Ð¾Ð¹ Ð·Ð°Ð´Ð°Ñ‡Ð¸.
                              button class="btn-info" onClick="return popup_hide('agree#{job.drms_job_id}_#{cond}')"
                                | ÐŸÐµÑ€ÐµÐ´ÑƒÐ¼Ð°Ð»
                        a class="octo-close-popup2" onClick="return popup_hide('agree#{job.drms_job_id}_#{cond}')"
                  - else
                    i class="em2 fas fa-fw fa-check color-green"
                    | Ð’ÑÑ‘ Ð² Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ, Ð·Ð°Ð¼ÐµÑ‡Ð°Ð½Ð¸Ð¹ Ð½ÐµÑ‚!
                - else
                  p 
                    | ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ðµ :(
              a class="octo-close-popup" onClick="$('#job_info_#{index}').removeClass('target')"
            td
              - if perf_data_present
                - if job_cond.size > 0
                  - hidden_count=0
                  - job_cond.each do |cond|
                    - rule = @rules_plus['rules'].fetch(cond, nil)
                    - icon = rule ? group_plus.fetch(rule['group'],def_icon) : def_icon
                    - hidden_count+=1 if @filters.include?(cond)
                    a href="all_rules#go-#{cond}" class="em12 #{@filters.include?(cond) ? 'hidden' : 'visible'}"
                      i class="fa-fw align-left #{icon['icon']} #{icon['color']} inline cond-div" title="#{@rules_plus['rules'].fetch(cond,{}).fetch('description','...')}" data-rule-div="#{cond}"
                    |  
                  - if hidden_count>0
                    - hidden=@jobs_plus[job.drms_job_id]['filtered']
                    span class="gray-text hidden_rules_count" data-id="#{job.drms_job_id}" title="Ð§Ð¸ÑÐ»Ð¾ ÑÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð»" +#{hidden}
                - else
                  /= image_tag "ok.png", size: "20", border: 2
                  i class="fas fa-fw fa-check em12 color-green" title="Ð’ÑÑ‘ Ð² Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ, Ð·Ð°Ð¼ÐµÑ‡Ð°Ð½Ð¸Ð¹ Ð½ÐµÑ‚!"
              - else
                p 
                  | ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…...
            td = link_to(job.drms_job_id, job)
            td class="login-data" = job.login
            td class="login-data" = job.partition
            td = job.start_time.strftime('%D %T')
            td = job.end_time.strftime('%D %T')
            td class="task_state_#{job.state} centered"
              /i class="em15 #{@finish_states.fetch(job.state, 'fas fa-meh-blank')}" title="#{job.state}"
              = job.state.downcase
            td
              / class="sorter-metrics1"
              /| #{job.num_nodes}/#{number_with_precision(job.get_duration_hours, :precision => 1)}/#{number_with_precision(job.get_cpuh, :precision => 1)}
              = job.num_nodes
            td
              = number_with_precision(job.get_duration_hours, :precision => 1)
            /td = number_with_precision(job.get_duration_hours, :precision => 1)

            /td = number_with_precision(job.get_cpuh, :precision => 1)

            /td = "ðŸŽ–" * Math.log(job.num_nodes * (job.end_time - job.start_time) / 86400 + 2, 2).to_i

            - stars=Math.log(job.num_nodes * (job.end_time - job.start_time) / 86400 + 2, 2)
            - stars=4 if stars>4
            td
              i class="icon-signal-#{stars.to_i} em2 centered" data-stars="#{stars}"
              br
              = number_with_precision(job.get_cpuh, :precision => 1)
              /== '<i class="fas fa-star"></i>' * stars.to_i
              /== '<i class="fas fa-star-half-alt"></i>' * (stars-stars.to_i > 0.5 ? 1 : 0)

            td class="perf-data job_metric_#{job_ranking[:cpu_user]}"
              = number_with_precision(job_performance[:cpu_user], :precision => 1)

            td class="perf-data job_metric_#{job_ranking[:gpu_load]}"
              = number_with_precision(job_performance[:gpu_load], :precision => 1)

            td class="perf-data job_metric_#{job_ranking[:loadavg]}"
              = number_with_precision(job_performance[:loadavg], :precision => 1)

            td class="perf-data job_metric_#{job_ranking[:ipc]}"
              = number_with_precision(job_performance[:ipc] && job_performance[:ipc], :precision => 2)

            td class="perf-data job_metric_#{job_ranking[:ib_rcv_data_mpi]}"
              = number_with_precision(job_performance[:ib_rcv_data_mpi], :precision => 1)

            td class="perf-data job_metric_#{job_ranking[:ib_xmit_data_mpi]}"
              = number_with_precision(job_performance[:ib_xmit_data_mpi], :precision => 1)

table
  tr
    td
      - if @params[:offset].to_i >= @PER_PAGE
        a href="#{url_for @params.except(:offset).merge(offset: @params[:offset].to_i - @PER_PAGE)}" <<< 
    td width="10px"
    td
      - if @jobs.length == 100
        a href="#{url_for @params.except(:offset).merge(offset: @params[:offset].to_i + @PER_PAGE)}" >>>
